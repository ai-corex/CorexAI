// pages/api/summary.js
export default async function handler(req, res) {
  const endpoints = ["flaunch", "creatorbid", "bankr", "clanker"];

  const fetcher = async (ep) => {
    const r = await fetch(`${process.env.NEXT_PUBLIC_BASE_URL}/api/${ep}`);
    return r.json();
  };

  const results = await Promise.all(endpoints.map(fetcher));

  const allTokens = results.flatMap(r => r.tokens || []);

  const summary = {
    total_tokens: allTokens.length,
    latest_launch: allTokens.sort((a,b)=>
      new Date(b.launch_date||0) - new Date(a.launch_date||0)
    )[0] || null
  };

  res.status(200).json(summary);
}
